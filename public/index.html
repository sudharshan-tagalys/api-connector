<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Search and search suggestions</title>
  <script src="./bundle.js"></script>
</head>

<body>
  <script>
    var setTagalysConfiguration = function (callback) {
      Tagalys.setConfiguration({
        track: true,
        analyticsStorageConsentProvided: () => {
          return true
        },
        api: {
          serverUrl: "https://stage2-api.tagalys.com",
          credentials: {
            clientCode: "676E7DE0213C3D74",
            apiKey: "47632ed716da1810cfe03bdabd11887a",
          },
          storeId: "79335653678",
        },
        platform: "Shopify",
        locale: "en-US",
        currency: {
          displayFormatter: "{{currencyLabel}}{{value}}",
          code: "USD",
          label: "$",
          fractionalDigits: 2,
          forceFractionalDigits: true,
        },
        countryCode: "US",
        track: true,
        analyticsStorageConsentProvided: function () {
          return false
        },
        // baseCountryCode: "US",
        // countryCode: "IN",
        platformVariables: {
          useStoreFrontAPIForProductPrices: true,
          storeFrontAPIAccessToken: "942cf991dbd2f945a7f671ea36f4761d",
          myShopifyDomain: "replication-one.myshopify.com",
          metafields: {
            products: [{
              namespace: "custom",
              key: "prod_ref"
            },
            {
              namespace: "custom",
              key: "api"
            },
            {
              namespace: "instructions",
              key: "wash"
            },
            {
              namespace: "custom",
              key: "prod_ref_list"
            },
            {
              namespace: "custom",
              key: "rating_list"
            },{
              namespace: "custom",
              key: "rating"
            },{
              namespace: "custom",
              key: "color_picker"
            },{
              namespace: "custom",
              key: "multi"
            },{
              namespace: "custom",
              key: "int"
            },
            {
              namespace: "custom",
              key: "col_ref"
            }]
          }
        }
      }, callback);
    }

    var onTagalysReady = function (callback) {
      window.addEventListener("DOMContentLoaded", function () {
        setTagalysConfiguration(callback)
      })
    }

    var params = {
      product_listing_page_id: "453200904494", // listing page id for which the products to be returned
    }
    onTagalysReady(function () {
      window.productListingPageInstance = Tagalys.ShopifyAPIConnector.ProductListingPage.new({
        params: params,
        failover: function () {
          return Tagalys.ShopifyAPIConnector.ProductListingPage.new({
            params: params,
            onSuccess: function (response, helpers) {
              console.log("ON SUCESS OF SHOPIFY API >>> ", response)
            },
            onFailure: function () {

            }
          })
        },
        onSuccess: function (response, helpers) {
          // Called after a successful API call
          // Use response to render the results - described below
          console.log("ON SUCESS OF TAGALYS API >>> ", response)
        }
      })
      console.log(window.productListingPageInstance)
      window.productListingPageInstance.helpers.call()
    })

  </script>
</body>

</html>