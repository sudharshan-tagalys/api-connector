var Tagalys;(()=>{"use strict";var t={607:function(t,e,n){var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.APIConnector=void 0;var o=n(395),i=n(628),a=n(902),s=n(122),u=n(620),c=function(t){return r(r({},i.DEFAULT_REQUEST_OPTIONS),t)};e.APIConnector={SimilarProducts:{call:function(t){return a.default.call(c(t))}},SmartWidget:{call:function(t){return s.default.call(c(t))}},SearchSuggestions:{call:function(t){return u.default.call(c(t))},new:function(t){return u.default.new(c(t))}},setConfiguration:function(t){return o.default.setConfiguration(r(r({},i.DEFAULT_CONFIGURATION),t))}},window.addEventListener("load",(function(){var t=new Event("tagalys:ready");document.dispatchEvent(t)}))},618:function(t,e,n){var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.COOKIES=void 0;var o=n(963),i=n(395),a=n(997);e.COOKIES={TA_DEVICE:"__ta_device",TA_VISIT:"__ta_visit",TA_LAST_PA_TIME:"__ta_last_pa_time"};var s=function(){function t(){this.lastEventTimestamp=!1,this.analyticsRapidEventSequence=0}return t.prototype.trackEvent=function(t,e){this.track("analytics/events/track",{eventType:t,details:e})},t.prototype.track=function(t,n,s){var u=n.eventType,c=n.details;if(void 0===s&&(s=3),a.default.isEnabled()){a.default.batchUpdate([{name:e.COOKIES.TA_DEVICE,expiryTime:63072e6},{name:e.COOKIES.TA_VISIT,expiryTime:18e5}]);var p={device_id:a.default.get(e.COOKIES.TA_DEVICE),visit_id:a.default.get(e.COOKIES.TA_VISIT)};this.analyticsRapidEventSequence=this.getAnalyticsRapidEventSequence(),this.lastEventTimestamp=Date.now();var l={event_type:u,details:c,rapid_event_sequence:this.analyticsRapidEventSequence,tracker_version:s,device_info:{},identification:r(r({},i.default.getApiIdentification()),{user:p})};o.default.call("POST",t,{params:JSON.stringify(l),onSuccess:function(t){if(u&&"product_action"==u&&t.hasOwnProperty("timestamp")){var n=t.timestamp.split("T")[1].substring(0,6);a.default.set(e.COOKIES.TA_LAST_PA_TIME,n,12e5)}}})}},t.prototype.getAnalyticsRapidEventSequence=function(){var t=999999,e=this.analyticsRapidEventSequence;return 0!=this.lastEventTimestamp&&(t=Math.floor((Date.now()-this.lastEventTimestamp)/1e3)),t<2?e+=1:e=0,e},t}();e.default=new s},963:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0});var r=n(395),o=function(){function t(){}return t.prototype.call=function(t,e,n,r){void 0===r&&(r={contentType:"application/x-www-form-urlencoded"});var o=new XMLHttpRequest;o.open(t,this.url(e)),o.setRequestHeader("Content-Type",r.contentType),o.onload=function(){200===o.status?n.onSuccess(JSON.parse(o.responseText)):void 0!==n.onFailure&&n.onFailure(JSON.parse(o.response))},o.onerror=function(){void 0!==n.onFailure&&n.onFailure(JSON.parse(o.response))},o.send(n.params)},t.prototype.url=function(t){return"".concat(r.default.getApiServer(),"/v1/").concat(t)},t}();e.default=new o},43:function(t,e,n){var r=this&&this.__assign||function(){return r=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},r.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var o=n(286),i=n(869),a=n(618),s=n(963),u=n(395),c=n(997),p={method:"POST",path:"",headers:{contentType:"application/x-www-form-urlencoded"},params:{}},l=function(){function t(){}return t.prototype.setResponseFormatter=function(){this.responseFormatter||(this.responseFormatter=i.default.responseFormatter())},t.prototype.call=function(t){var e=this;this.requestOptions=t,this.setResponseFormatter();var n=r(r({},p),this.getRequestOptions()),o=n.method,i=n.path,a=n.params;s.default.call(o,i,{params:this.formatRequestParams(r(r({},a),{identification:u.default.getApiIdentification()})),onSuccess:function(t){e.isFailureResponse(t)?e.requestOptions.onFailure(t):e.onSuccessfulResponse(t)},onFailure:function(t){e.requestOptions.onFailure(t)}})},t.prototype.formatRequestParams=function(t){return(0,o.objectToFormData)(t)},t.prototype.onSuccessfulResponse=function(t){var e=this.extractAnalyticsData(t),n=this.formatResponse(t);this.requestOptions.onSuccess(n,e),u.default.canTrackAnalytics()&&a.default.trackEvent(e.event_type,e.event_details),u.default.analyticsStorageConsentProvided()||c.default.batchDelete(Object.values(a.COOKIES))},t.prototype.extractAnalyticsData=function(t){return t},t.prototype.formatResponse=function(t){return t},t.prototype.getRequestOptions=function(){return{}},t.prototype.isFailureResponse=function(t){return!1},t}();e.default=l},395:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.prototype.setConfiguration=function(t){this.validateConfiguration(t),this.configuration={identification:{client_code:t.credentials.clientCode,api_key:t.credentials.apiKey,store_id:t.storeId,currency:t.currencyCode,api_client:t.apiClient},platform:t.platform,apiServer:t.apiServer,track:t.track,analyticsStorageConsentProvided:t.analyticsStorageConsentProvided}},t.prototype.validateConfiguration=function(t){var e=this;["apiServer","credentials","storeId","currencyCode"].forEach((function(n){if(!t.hasOwnProperty(n))throw new Error(e.getConstructedErrorLabel(n))})),["clientCode","apiKey"].forEach((function(n){if(!t.credentials.hasOwnProperty(n))throw new Error(e.getConstructedErrorLabel(n))}))},t.prototype.getConstructedErrorLabel=function(t){return"".concat(t," configuration is missing. Refer docs.")},t.prototype.getConfiguration=function(){return this.configuration},t.prototype.getApiServer=function(){return this.configuration.apiServer},t.prototype.getApiIdentification=function(){return this.configuration.identification},t.prototype.getPlatform=function(){return this.configuration.platform.toLowerCase()},t.prototype.analyticsStorageConsentProvided=function(){return this.configuration.analyticsStorageConsentProvided()},t.prototype.canTrackAnalytics=function(){return this.configuration.track&&this.configuration.analyticsStorageConsentProvided()},t}();e.default=new n},997:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.prototype.isEnabled=function(){var t=navigator.cookieEnabled;return t||(document.cookie="testcookie",t=-1!=document.cookie.indexOf("testcookie")),t},t.prototype.batchUpdate=function(t){var e=this;t.forEach((function(t){return e.update(t)}))},t.prototype.update=function(t){var e=t.name,n=t.value,r=void 0===n?"":n,o=t.expiryTime,i=this.get(r);""===i&&(i=function(t){for(var e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",n="",r=32;r>0;--r)n+=e[Math.round(Math.random()*(e.length-1))];return n}()),this.set(e,i,o)},t.prototype.get=function(t){for(var e=t+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var o=n[r];" "==o.charAt(0);)o=o.substring(1);if(0==o.indexOf(e)){var i=o.substring(e.length,o.length);return i.replace(/%3B/g,";")}}return""},t.prototype.set=function(t,e,n){var r=new Date;r.setTime(r.getTime()+n);var o="expires="+r.toUTCString();e=e.replace(/;/g,"%3B"),-1===window.location.hostname.indexOf(".")?document.cookie=t+"="+e+"; "+o+"; path=/; domain="+window.location.hostname:document.cookie=t+"="+e+"; "+o+"; path=/; domain=."+window.location.hostname},t.prototype.delete=function(t){this.set(t,"",-1)},t.prototype.batchDelete=function(t){var e=this;t.forEach((function(t){return e.delete(t)}))},t}();e.default=new n},620:function(t,e,n){var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},i.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getRequestOptions=function(){return{path:"ss",params:{q:this.requestOptions.params.query,products:this.requestOptions.params.request.products,queries:this.requestOptions.params.request.queries}}},e.prototype.extractAnalyticsData=function(t){return t},e.prototype.onSuccessfulResponse=function(t){this.requestOptions.onSuccess(this.responseFormatter.searchSuggestions(t,this.requestOptions.configuration))},e.prototype.formatRequestParams=function(t){return JSON.stringify(t)},e.prototype.setQuery=function(t,e){this.requestOptions=i(i({},this.requestOptions),{params:i(i({},this.requestOptions.params),{query:t})}),e&&this.call(this.requestOptions)},e.prototype.new=function(t){var e=this;return this.requestOptions=t,{setQuery:function(t,n){return void 0===n&&(n=!0),e.setQuery(t,n)}}},e}(n(43).default);e.default=new a},628:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.DEFAULT_REQUEST_OPTIONS=e.DEFAULT_CONFIGURATION=e.SHOPIFY_PLATFORM=void 0,e.SHOPIFY_PLATFORM="shopify",e.DEFAULT_CONFIGURATION={platform:"custom",apiClient:{vendor:"tagalys",language:"js",version:"3",release:"1"},track:!0,analyticsStorageConsentProvided:function(){return!1}};var n={configuration:{},onSuccess:function(t){console.log("API response:",t)},onFailure:function(t){console.error("Failed API response:",t)}};e.DEFAULT_REQUEST_OPTIONS=n},286:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.objectToFormData=void 0;var n=function(t){var e={};for(var r in t)if(t.hasOwnProperty(r))if("object"==typeof t[r]&&null!==t[r]){var o=n(t[r]);for(var i in o)o.hasOwnProperty(i)&&(e[r+"."+i]=o[i])}else e[r]=t[r];return e};e.objectToFormData=function(t){var e=n(t);return Object.keys(e).map((function(t){var n;return n=-1==t.indexOf(".")?t:t.replace(/.\d+/g,".").split(".").join("][").replace("]","")+"]",encodeURIComponent(n)+"="+encodeURIComponent(e[t])})).join("&")}},869:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0});var r=n(395),o=n(357),i=n(670);e.default={responseFormatter:function(){return"shopify"===r.default.getPlatform()?new i.default:new o.default}}},357:function(t,e){var n=this&&this.__assign||function(){return n=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){var t=this;this.formatDetail=function(e){for(var r={},o={},i=0,a=Object.entries(e);i<a.length;i++){var s=a[i],u=s[0],c=s[1];if(!t.isIgnoredField(u))if(t.isPlatformField(u)){var p=t.translatePlatformField(u,e),l=p.key,f=p.value;o[l]=f}else r[u]=c}return n(n(n({},o),t.additionalPlatformFields(e)),{__tagalys_fields:r})}}return t.prototype.formatDetails=function(t){return t.map(this.formatDetail)},t.prototype.platformFieldTranslations=function(){return{}},t.prototype.additionalPlatformFields=function(t){return{}},t.prototype.fieldsToIgnore=function(){return[]},t.prototype.isPlatformField=function(t){return this.platformFieldTranslations().hasOwnProperty(t)},t.prototype.isIgnoredField=function(t){return this.fieldsToIgnore().includes(t)},t.prototype.translatePlatformField=function(t,e){var n=this.platformFieldTranslations();return"function"==typeof n[t]?(0,n[t])(e):{key:n[t],value:e[t]}},t.prototype.similarProducts=function(t){return t},t.prototype.smartWidgets=function(t){return t},t.prototype.searchSuggestions=function(t,e){return t},t}();e.default=r},670:function(t,e,n){var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),i=this&&this.__assign||function(){return i=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},i.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.platformFieldTranslations=function(){return{__id:function(t){return{key:"id",value:parseInt(t.__id)}},name:"title",price:"compare_at_price",sale_price:"price",introduced_at:"published_at",shopify_tags:function(t){return Array.isArray(t.shopify_tags)?{key:"tags",value:t.shopify_tags}:{key:"tags",value:t.shopify_tags.split(", ").sort()}},_vendor:function(t){return Array.isArray(t._vendor)?{key:"vendor",value:t._vendor[0]}:{key:"vendor",value:t._vendor}},images:"images",variants:"variants"}},e.prototype.additionalPlatformFields=function(t){return{handle:t.link.split("/products/")[1]}},e.prototype.similarProducts=function(t){return{products:this.formatDetails(t.details)}},e.prototype.smartWidgets=function(t){return{name:t.name,widget_name:t.widget_name,products:this.formatDetails(t.details)}},e.prototype.searchSuggestions=function(t,e){var n=function(t,n){void 0===n&&(n={});var r,o=e.queryString,i=o.query,a=o.queryFilter,s="?".concat(i,"=");if(void 0===n||0===Object.keys(n).length)return s+encodeURIComponent(t);r=Object.keys(n).map((function(t){return encodeURIComponent(t)+"-"+encodeURIComponent(n[t])})).join("~");var u=encodeURIComponent("".concat(a))+"="+r;return s.concat(encodeURIComponent(t)+"&"+u)};return{queries:function(t){return t.queries?t.queries.map((function(t){var r,o={displayString:"",queryString:"",rawQuery:t};if("string"==typeof t.query)return o.displayString=t.query,o.queryString=n(t.query),o;if(Array.isArray(t.query))if(t.hasOwnProperty("in")){var a=t.query.join(""),s=t.in.hierarchy.map((function(t){return t.name})).join(" ".concat(e.hierachySeperator," ")),u=i(i({},t.filter),((r={})["".concat(t.in.tag_set.id)]=t.in.hierarchy.map((function(t){return t.id})),r));o.displayString="".concat(a," ").concat(e.hierachySeperator," ").concat(s),o.queryString=n(o.displayString,u)}else o.displayString=t.query.join(" ".concat(e.categorySeperator," ")),o.queryString=n(o.displayString,t.filter);return o})):[]}(t),products:this.formatDetails(t.products)}},e.prototype.fieldsToIgnore=function(){return["sku"]},e}(n(357).default);e.default=a},902:function(t,e,n){var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getRequestOptions=function(){return{path:"products/".concat(this.requestOptions.params.productId,"/similar"),params:{request:["result","details"],max_products:this.requestOptions.params.limit||16}}},e.prototype.formatResponse=function(t){return this.responseFormatter.similarProducts(t)},e.prototype.isFailureResponse=function(t){return"OK"!=t.status},e.prototype.extractAnalyticsData=function(t){var e={};t.hasOwnProperty("sku")&&(e.sku=t.sku);var n=t.details.map((function(t){return t.sku}));return{event_type:"product_list",event_details:{pl_type:"widget-similar_products",pl_details:e,pl_products:n,pl_total:n.length}}},e}(n(43).default);e.default=new i},122:function(t,e,n){var r,o=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)});Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.getRequestOptions=function(){return{path:"custom_widgets/".concat(this.requestOptions.params.widgetId),params:{request:["result","details"],max_products:this.requestOptions.params.limit||16}}},e.prototype.formatResponse=function(t){return this.responseFormatter.smartWidgets(t)},e.prototype.extractAnalyticsData=function(t){var e={id:this.requestOptions.params.widgetId,title:t.name},n=t.details.map((function(t){return t.sku}));return{event_type:"product_list",event_details:{pl_type:"widget-custom",pl_details:e,pl_products:n,pl_total:n.length}}},e}(n(43).default);e.default=new i}},e={},n=function n(r){var o=e[r];if(void 0!==o)return o.exports;var i=e[r]={exports:{}};return t[r].call(i.exports,i,i.exports,n),i.exports}(607);Tagalys=n})();